#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f logcollector.sh -o logcollector 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[1]))
	"\060\350\167\054\017\322\134\232\255\331\257\203\134\257\374\023"
	"\141\035\044\050\345\100\017\050\174\202\111\103\137\277\237\307"
	"\011\012\107\043\155\066\125\334\005\272\235\273\261\140\242\103"
	"\343\302\044\136\143\372\004\040\102\370\357\124\025\117\102\337"
	"\371\333\313\050\225"
#define      date_z	1
#define      date	((&data[69]))
	"\161"
#define      pswd_z	256
#define      pswd	((&data[123]))
	"\255\121\315\033\056\355\044\312\170\212\261\325\120\107\161\121"
	"\340\035\152\362\127\233\276\177\061\335\017\105\345\340\122\223"
	"\062\040\257\140\015\323\053\205\135\334\133\255\044\315\377\004"
	"\352\152\367\101\005\102\363\232\050\353\245\074\003\252\012\045"
	"\101\157\227\053\162\143\376\273\274\331\200\267\120\143\270\022"
	"\126\171\047\033\274\033\265\344\006\133\041\012\006\054\057\110"
	"\233\307\163\015\052\162\311\346\113\111\236\234\255\126\256\003"
	"\320\325\036\214\360\324\161\367\060\222\001\066\276\061\177\132"
	"\370\363\147\042\145\061\011\261\172\250\115\047\377\373\053\317"
	"\321\112\134\301\037\315\271\120\140\272\207\037\354\006\171\344"
	"\371\341\007\137\022\020\020\215\271\135\265\270\130\341\210\051"
	"\054\344\353\114\262\245\234\023\140\043\062\114\051\253\060\043"
	"\215\070\202\240\110\222\056\002\357\343\272\110\305\103\162\362"
	"\050\136\076\333\003\332\356\143\375\040\257\047\314\340\112\131"
	"\030\315\371\141\137\050\143\117\013\036\227\321\142\012\303\212"
	"\150\001\145\154\334\123\317\332\164\177\001\101\140\114\232\170"
	"\031\224\332\171\274\076\310\310\135\137\232\277\152\135\111\322"
	"\137\257\077\074\003\016\026\170\216\030\271\356\145\124\147\176"
	"\350\101\370\245\177\300\156\335\040\010\234\212\146\346\135\305"
	"\225\234\001\231\253\265\300\066"
#define      chk1_z	22
#define      chk1	((&data[386]))
	"\171\260\317\014\177\325\142\024\032\313\223\227\305\370\105\226"
	"\275\112\077\307\241\172\132\364\270\155\343\357"
#define      opts_z	1
#define      opts	((&data[410]))
	"\354"
#define      msg2_z	19
#define      msg2	((&data[413]))
	"\355\114\133\057\056\273\373\314\261\331\307\126\160\133\143\023"
	"\025\125\371\206\173\335\233"
#define      lsto_z	1
#define      lsto	((&data[434]))
	"\206"
#define      tst1_z	22
#define      tst1	((&data[438]))
	"\155\326\012\027\330\131\302\002\061\014\344\240\201\200\371\164"
	"\311\025\025\310\004\172\155\153\102"
#define      shll_z	10
#define      shll	((&data[461]))
	"\266\176\105\274\140\315\015\062\013\100\160"
#define      rlax_z	1
#define      rlax	((&data[471]))
	"\271"
#define      inlo_z	3
#define      inlo	((&data[472]))
	"\346\272\001"
#define      chk2_z	19
#define      chk2	((&data[477]))
	"\077\170\100\341\144\055\356\327\011\213\211\327\254\335\011\112"
	"\367\245\317\300\266\207\257\372\164"
#define      xecc_z	15
#define      xecc	((&data[503]))
	"\154\203\252\232\246\067\304\333\225\123\102\205\022\215\044\233"
	"\101\370"
#define      tst2_z	19
#define      tst2	((&data[518]))
	"\022\242\366\274\000\272\110\353\104\110\263\124\027\020\262\036"
	"\213\062\000\116\356\271"
#define      text_z	1993
#define      text	((&data[802]))
	"\050\356\267\130\006\103\224\002\276\214\101\066\024\360\061\210"
	"\354\011\230\130\214\102\071\244\362\210\223\254\372\032\246\043"
	"\010\136\173\017\241\020\021\140\235\122\227\261\103\311\072\057"
	"\322\322\207\137\025\300\004\007\111\230\263\103\262\132\146\273"
	"\270\342\312\132\362\333\273\220\055\122\101\160\033\173\237\356"
	"\116\047\116\143\347\122\152\061\352\036\164\235\170\333\130\060"
	"\275\042\212\260\375\105\100\053\230\202\234\264\375\074\243\113"
	"\143\361\256\113\103\031\174\056\067\361\313\260\314\044\340\212"
	"\106\153\073\104\261\173\160\112\375\015\377\373\111\242\106\255"
	"\224\365\370\327\017\164\006\107\146\322\367\062\366\330\275\075"
	"\103\370\202\365\163\362\100\161\377\077\154\111\342\263\366\166"
	"\251\356\116\270\143\124\377\311\046\366\374\035\317\271\132\023"
	"\261\334\010\045\316\111\226\316\210\003\027\153\266\015\341\140"
	"\374\057\030\140\204\030\052\253\017\046\310\336\340\042\361\222"
	"\376\372\267\315\103\116\233\314\121\263\067\010\301\030\150\275"
	"\110\201\036\315\231\110\170\250\156\100\207\117\143\170\341\141"
	"\162\230\056\266\347\312\323\073\332\062\264\317\045\176\377\205"
	"\371\070\220\105\225\334\066\354\211\040\201\106\040\077\340\264"
	"\256\100\245\263\333\222\302\071\231\100\364\303\224\175\044\047"
	"\327\372\332\035\214\313\055\050\212\352\145\261\013\032\054\246"
	"\061\355\207\355\020\312\054\140\264\223\076\040\010\311\216\136"
	"\024\057\333\051\223\006\341\362\374\000\267\222\153\075\255\216"
	"\107\131\250\357\201\063\074\051\347\145\017\012\163\327\137\352"
	"\070\335\026\023\157\055\044\005\334\371\066\276\126\144\356\250"
	"\325\320\257\253\366\362\057\362\131\335\323\352\206\042\005\113"
	"\001\222\002\234\023\101\160\066\233\315\116\070\143\346\016\061"
	"\215\061\076\102\274\161\175\035\232\007\076\155\367\222\061\312"
	"\106\255\274\065\045\215\045\265\343\317\163\375\304\321\132\102"
	"\011\266\107\032\153\376\161\233\163\074\007\373\275\367\241\236"
	"\277\026\214\025\251\014\116\055\064\241\143\024\357\107\241\232"
	"\067\334\042\333\110\230\105\245\212\160\057\072\013\024\212\260"
	"\123\026\342\310\165\363\054\003\145\274\357\301\241\247\325\020"
	"\314\076\171\070\355\063\171\103\045\055\344\023\203\222\257\123"
	"\002\156\135\224\207\230\136\217\255\036\105\341\154\236\121\036"
	"\262\176\256\367\046\200\360\247\131\210\306\341\224\241\100\202"
	"\067\252\376\011\377\177\033\357\300\115\307\203\076\217\347\271"
	"\254\027\001\030\076\135\375\317\164\307\333\136\170\366\240\306"
	"\310\303\027\325\227\142\344\265\346\311\171\260\225\221\063\047"
	"\100\270\355\366\353\334\247\241\024\007\250\024\031\261\021\021"
	"\170\014\266\256\321\043\372\000\136\203\164\356\313\337\060\005"
	"\202\077\135\013\213\232\164\204\210\201\147\014\375\332\170\044"
	"\063\003\316\132\320\361\376\033\340\201\222\164\300\055\361\270"
	"\224\115\122\156\054\272\204\007\143\013\102\176\121\134\077\170"
	"\340\330\313\224\301\167\076\175\343\256\160\260\035\060\376\251"
	"\210\010\077\156\104\337\047\216\043\175\063\330\101\153\301\037"
	"\333\220\362\257\123\147\274\043\262\256\277\355\242\311\226\004"
	"\177\143\106\015\270\023\334\336\307\276\036\360\307\161\250\011"
	"\050\213\050\367\217\161\302\105\244\112\075\050\361\275\105\216"
	"\115\256\350\354\042\166\326\027\161\040\253\161\037\024\000\251"
	"\252\315\171\104\225\046\054\272\233\132\323\322\046\214\315\050"
	"\305\005\113\224\157\012\306\224\162\067\152\350\305\121\334\245"
	"\373\172\275\325\174\322\037\157\125\327\277\075\370\301\344\170"
	"\120\200\063\166\206\135\246\143\321\350\210\167\124\153\117\244"
	"\135\031\040\126\213\135\274\073\175\103\237\043\030\316\067\301"
	"\037\351\051\056\206\205\033\013\376\146\051\364\000\105\303\125"
	"\141\211\337\207\366\337\141\243\223\355\003\232\213\145\334\047"
	"\076\230\323\242\276\265\010\111\034\020\317\151\216\134\225\011"
	"\126\304\157\122\070\275\011\275\260\322\221\122\363\210\277\162"
	"\222\104\047\147\170\010\305\211\025\063\025\154\201\143\045\013"
	"\133\371\221\256\333\016\264\264\051\002\125\025\361\343\253\060"
	"\024\011\102\311\226\334\022\276\033\100\134\141\277\352\377\245"
	"\300\351\221\112\055\004\331\125\014\307\355\024\324\151\177\027"
	"\150\271\001\136\372\001\041\144\311\370\267\255\125\006\231\017"
	"\150\176\141\146\173\356\363\026\323\360\107\202\001\066\215\060"
	"\346\045\274\236\043\321\042\265\370\375\000\147\065\023\123\136"
	"\273\222\362\240\066\061\261\036\352\275\174\321\177\274\146\151"
	"\000\121\076\327\145\057\200\202\164\327\250\325\203\121\047\376"
	"\112\251\125\333\355\231\374\003\226\175\261\274\125\352\134\216"
	"\115\344\070\150\026\377\253\221\322\116\373\105\151\224\265\101"
	"\116\136\310\112\151\347\135\036\252\000\331\367\144\253\165\276"
	"\142\260\237\371\002\027\015\377\113\023\371\011\373\137\342\347"
	"\021\275\174\263\301\071\005\355\256\251\005\052\066\265\142\210"
	"\165\052\317\312\223\310\310\373\064\354\052\063\111\354\350\134"
	"\376\241\277\061\220\165\012\325\006\005\352\107\347\012\341\271"
	"\231\120\251\106\016\342\116\275\242\201\174\321\022\017\003\256"
	"\061\376\076\206\314\113\265\356\055\336\154\067\357\162\022\312"
	"\056\204\265\307\367\142\271\141\346\200\270\120\351\322\344\037"
	"\214\256\105\020\017\257\007\350\013\303\267\255\140\001\057\006"
	"\231\036\204\005\146\226\372\375\371\342\076\164\001\323\073\005"
	"\346\373\343\040\014\251\272\010\235\226\174\356\300\203\164\140"
	"\022\361\376\126\100\314\275\006\214\012\312\240\156\156\113\050"
	"\377\235\323\251\340\221\060\123\336\224\167\121\346\137\354\367"
	"\113\112\035\210\054\250\044\011\230\343\026\357\344\341\333\236"
	"\233\042\174\310\130\237\227\156\246\176\073\307\351\111\163\162"
	"\236\273\117\320\321\051\225\140\012\341\053\307\276\376\104\152"
	"\164\201\100\022\223\254\025\104\200\304\277\012\311\325\317\310"
	"\260\253\276\207\177\006\166\136\053\200\351\010\326\037\231\257"
	"\156\257\343\074\236\117\303\257\103\055\366\333\132\240\205\306"
	"\133\333\006\312\141\063\150\174\011\005\066\333\055\046\160\070"
	"\114\144\330\050\142\274\272\176\071\151\226\003\347\143\260\171"
	"\173\106\341\275\312\106\166\211\322\143\262\244\355\217\121\326"
	"\136\136\373\034\206\054\150\110\270\040\174\014\372\140\343\017"
	"\315\360\160\013\256\300\162\001\043\253\344\175\075\157\116\240"
	"\060\252\077\276\261\055\264\237\327\066\203\121\070\117\222\350"
	"\242\046\245\303\225\340\246\051\307\054\175\074\371\254\273\204"
	"\127\301\205\224\003\377\272\235\004\202\030\316\005\162\254\050"
	"\021\300\021\277\320\366\323\257\230\374\075\150\376\035\103\376"
	"\144\054\227\135\372\377\260\307\321\147\374\072\234\002\053\030"
	"\162\164\156\234\102\220\272\026\157\161\357\060\171\320\207\307"
	"\064\257\047\202\100\260\332\036\205\050\073\313\360\032\141\163"
	"\206\271\302\340\130\021\174\255\214\377\203\352\304\366\307\264"
	"\102\210\067\052\312\326\014\041\005\214\011\340\024\353\014\103"
	"\325\041\070\051\254\202\213\275\170\161\130\106\114\024\341\000"
	"\175\357\126\046\157\072\053\222\213\321\015\067\173\024\222\110"
	"\261\011\035\102\203\356\232\300\240\320\073\225\312\335\372\000"
	"\220\255\026\333\234\366\133\356\052\260\034\037\247\274\075\155"
	"\156\171\353\240\257\107\177\351\012\151\320\345\310\257\335\034"
	"\203\111\374\061\335\160\015\313\167\013\265\072\251\027\152\370"
	"\104\120\217\045\171\236\336\250\035\213\152\353\114\212\274\055"
	"\032\323\052\067\273\332\354\300\331\357\246\235\374\223\305\127"
	"\241\134\346\022\325\324\062\307\174\110\332\252\234\115\050\070"
	"\335\351\122\376\044\120\073\145\044\327\224\266\025\202\140\161"
	"\215\361\271\167\334\173\122\071\272\335\354\226\036\303\014\315"
	"\350\260\245\100\055\007\300\253\164\061\176\256\022\302\065\230"
	"\042\312\102\054\370\007\370\014\306\256\343\125\317\033\014\344"
	"\347\146\243\040\025\365\125\061\147\307\104\220\140\016\045\206"
	"\122\214\103\074\154\135\117\021\073\116\276\116\177\023\026\137"
	"\004\235\316\305\363\026\033\066\034\305\143\044\076\261\314\243"
	"\142\236\126\054\110\115\013\313\334\217\137\163\001\327\316\123"
	"\021\140\224\202\367\246\353\137\115\147\064\263\131\320\041\117"
	"\155\032\131\102\002\073\357\150\352\270\351\277\132\115\037\347"
	"\330\051\263\206\356\176\312\117\173\141\135\154\332\251\267\273"
	"\051\347\273\146\222\275\270\266\032\127\125\262\352\127\070\306"
	"\260\245\004\032\124\316\341\170\003\060\067\125\032\324\217\244"
	"\021\372\277\005\122\200\170\233\076\000\274\056\134\125\262\235"
	"\112\160\332\312\110\230\377\172\241\335\201\120\232\033\103\377"
	"\356\242\051\220\277\313\161\021\212\140\327\257\370\132\060\237"
	"\240\106\252\210\266\161\040\102\067\133\256\217\336\301\042\101"
	"\354\005\057\323\031\305\354\026\341\310\130\245\010\320\217\140"
	"\300\107\027\370\211\112\374\354\072\021\352\254\242\060\262\350"
	"\225\224\144\125\237\235\264\273\065\136\017\120\060\300\361\346"
	"\040\355\213\370\257\325\256\377\244\106\014\242\215\252\204\364"
	"\012\251\176\021\325\113\066\370\262\300\313\221\011\117\330\117"
	"\317\157\214\034\136\333\216\312\332\371\313\130\013\111\323\371"
	"\234\065\332\270\154\234\133\277\051\263\223\220\236\055\142\172"
	"\001\215\342\131\001\011\347\276\356\231\003\275\066\012\306\210"
	"\105\067\220\037\141\172\370\063\033\215\012\075\041\236\155\254"
	"\055\131\140\052\245\346\007\213\267\054\163\273\360\266\370\300"
	"\375\315\007\230\227\112\243\047\323\121\277\276\311\222\040\356"
	"\306\256\253\115\334\175\253\335\335\327\217\320\176\227\134\075"
	"\211\032\212\156\206\064\065\104\222\006\154\360\074\115\373\202"
	"\071\175\272\101\077\322\252\375\033\053\033\350\305\143\141\156"
	"\322\241\365\041\004\155\002\146\340\233\225\227\203\140\032\274"
	"\336\324\376\035\247\250\032\302\324\065\253\231\230\014\007\153"
	"\256\375\214\263\153\217\032\114\053\257\343\256\020\375\153\356"
	"\321\151\013\171\022\045\073\346\133\347\200\364\364\210\137\243"
	"\205\354\127\361\174\161\075\247\041\040\126\061\036\301\040\360"
	"\052\053\151\075\121\245\043\255\215\244\241\201\055\000\045\263"
	"\355\174\244\151\356\341\021\020\002\150\102\041\051\142\021\124"
	"\216\173\221\337\041\265\214\256\132\056\060\207\057\125\072\034"
	"\322\337\206\301\300\230\322\303\000\024\344\051\167\366\176\005"
	"\162\020\345\223\306\162\101\040\241\162\250\320\307\343\355\232"
	"\302\163\134\203\014\057\106\014\104\053\066\273\041\264\301\223"
	"\304\247\047\213\032\150\253\273\332\123\213\242\066\171\075\371"
	"\354\232\174\370\311\302\005\015\355\073\311\017\357\212\243\264"
	"\062\312\077\114\063\353\007\015\077\223\260\166\014\356\157\371"
	"\210\353\362\121\256\367\137\234\063\050\254\043\263\117\330\345"
	"\032\030\062\115\003\071\133\102\315\013\271\332\371\050\323\202"
	"\024\306\324\303\276\063\137\361\134\014\025\017\133\355\365\165"
	"\005\047\303\010\141\036\113\056\052\005\011\044\056\335\246\103"
	"\243\172\006\142\255\146\124\012\162\151\032\316\126\017\104\134"
	"\067\007\145\230\046\261\307\120\266\320\164\344\255\032\047\121"
	"\225\056\264\103\225\010\115\010\162\147\326\311\167\033\045\256"
	"\043\212\106\111\073\016\232\362\336\016\327\214\051\377\336\277"
	"\055\222\002\303\232\117\313\014\267\241\325\056\274\373\334\337"
	"\205\043\051\301\061\303\264\020\322\213\235\374\212\173\273\270"
	"\015\275\173\247\015\106\264\304\350\212\363\245\205\317\204\012"
	"\363\256\314\045\161\200\065\104\014\322\100\227\116\373\117\133"
	"\271\313\003\307\022\270\213\372\102\177\237\307\117\044\322\102"
	"\323\237\147\104\040\235\211\054\160\311\303\276\305\023\032\177"
	"\337\035\106\361\326\322\353\030\121\213\337\240\260\262\343\203"
	"\121\113\310\161\350\121\236"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
